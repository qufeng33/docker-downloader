# 开发环境配置规范

## 开发工具链配置

### 必需环境

- **Node.js**: >= 22.0.0 (使用 LTS 版本)
- **pnpm**: >= 10.0.0 (项目包管理器)
- **Python**: >= 3.8 (用于 node-gyp 编译原生模块)
- **Git**: >= 2.0.0 (版本控制)

### 推荐开发工具

- **IDE**: Visual Studio Code 或 WebStorm
- **调试工具**: Chrome DevTools、Vue DevTools
- **API 测试**: Postman 或 Insomnia (测试 Docker Registry API)

## 项目初始化流程

### 环境检查要求

- 开发前必须验证 Node.js 版本符合最低要求
- 包管理器版本必须满足项目兼容性要求
- Python 环境必须正确配置用于原生模块编译

### 依赖安装要求

- 必须使用 pnpm 作为包管理器安装依赖
- 安装完成后必须验证类型检查通过
- 应定期更新依赖并检查安全漏洞

## 调试和测试流程

### 主进程调试要求

- 必须使用专业的调试工具进行主进程调试
- 调试时应在关键业务逻辑处设置断点
- 调试信息必须通过 electron-log 统一输出
- 调试过程中应验证服务间的依赖注入是否正确
- 调试日志必须包含模块名称和上下文信息

### 渲染进程调试要求

- 必须使用浏览器开发者工具进行渲染进程调试
- 应安装并使用 Vue 专用的开发工具扩展
- 组件调试应重点关注状态管理和生命周期
- 性能调试应使用性能分析工具

### IPC 通信调试要求

- IPC 调用的输入输出必须通过 electron-log 完整记录
- 调试日志应包含请求参数、响应结果和执行时间
- 异常情况的调试信息应包含完整的错误堆栈
- 调试模式下应启用详细的 IPC 通信跟踪
- IPC 日志必须区分主进程和渲染进程来源

### 单元测试规范

- 必须使用 Jest 作为测试框架
- 测试文件命名必须遵循约定的后缀格式
- 每个服务类都必须有对应的单元测试
- 测试覆盖率必须达到 80% 以上
- 测试应包含正常流程和异常情况

### 集成测试要求

- 必须测试 IPC 通信的完整流程
- 网络请求和文件操作必须使用模拟对象
- 错误处理机制必须通过测试验证
- 集成测试应覆盖主要的用户使用场景

## 代码质量检查规范

### 任务完成流程

- 每完成一个任务后，必须执行 `pnpm run lint` 进行代码规范检查
- 如果发现 lint 错误，必须修复后才能标记任务为完成状态
- 确保所有代码都符合项目的 ESLint 配置规范
- 保持代码风格的一致性和可读性

### 代码检查标准

- 遵循项目的 TypeScript 和 ESLint 配置
- 确保没有未使用的变量和导入
- 保持一致的代码格式和缩进
- 函数和类的命名符合规范
- 如果 lint 检查失败，必须先修复所有问题
- 不允许跳过或忽略 lint 错误

## 构建和打包规范

### 开发构建要求

- 构建前必须通过类型检查和代码质量检查
- 代码格式化必须符合项目规范
- 代码检查必须无错误和警告
- 构建过程应提供详细的进度信息

### 生产构建流程要求

- 生产构建必须按照严格的顺序执行检查步骤
- 任何检查步骤失败都应中止构建流程
- 构建产物应针对不同平台进行优化
- 构建完成后应验证产物的完整性

## 版本控制规范

### Git 工作流

- 使用 Git Flow 或 GitHub Flow
- 主分支：`main` (生产环境)
- 开发分支：`develop` (开发环境)
- 功能分支：`feature/功能名称`
- 修复分支：`hotfix/问题描述`

### 提交信息规范要求

- 提交信息必须包含类型标识和简短描述
- 提交信息应使用中文描述，便于团队理解
- 新功能开发必须使用 feat 类型
- 问题修复必须使用 fix 类型
- 文档更新必须使用 docs 类型
- 代码重构必须使用 refactor 类型

## 性能监控和调试

### 性能分析工具

- Chrome DevTools Performance 面板
- Electron 内置的性能监控
- 内存使用情况监控

### 开发环境日志配置

- 开发环境必须启用 DEBUG 级别日志
- 调试日志必须包含完整的执行路径信息
- IPC 通信必须记录详细的调用信息

## 故障排查指南

### 常见问题解决

- 依赖安装失败时应先清除缓存再重新安装
- 类型检查错误应检查配置文件和类型定义
- 构建失败应验证环境变量和依赖完整性
- IPC 通信问题应检查 preload 脚本和方法签名
